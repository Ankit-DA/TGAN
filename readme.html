

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TGAN &mdash; TGAN 0.1.1-dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/dai-logo-white.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tgan package" href="api/tgan.html" />
    <link rel="prev" title="TGAN" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TGAN
          

          
            
            <img src="_static/dai-logo-white-200.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TGAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#requirements">Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#python">Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#data-format">Data Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-format">Input Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-format">Output Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#demo-datasets">Demo Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#census-dataset">Census dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cover-type">Cover type</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#quickstart">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#load-the-data">1. Load the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-tgan-instance">2. Create a TGAN instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fit-the-model">3. Fit the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-new-data">4. Sample new data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#save-and-load-a-model">5. Save and Load a model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#loading-custom-datasets">Loading custom datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="#model-parameters">Model Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-general-behavior">Model general behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="#neural-network-definition-and-fitting">Neural network definition and fitting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#command-line-interface">Command-line interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#random-hyperparameter-search">Random hyperparameter search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution">Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#research">Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="#what-s-next">Whatâ€™s next?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#citing-tgan">Citing TGAN</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/tgan.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/tgan.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.research.html">tgan.research package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/tgan.research.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/tgan.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.cli.html">tgan.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.data.html">tgan.data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.model.html">tgan.model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.trainer.html">tgan.trainer module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#types-of-contributions">Types of Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#report-bugs">Report Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#fix-bugs">Fix Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#implement-features">Implement Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#write-documentation">Write Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#submit-feedback">Submit Feedback</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#unit-testing-guidelines">Unit Testing Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#tips">Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#release-workflow">Release Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a><ul>
<li class="toctree-l2"><a class="reference internal" href="history.html#id1">0.1.0</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TGAN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>TGAN</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/DAI-Lab/TGAN/blob/master/docs/readme.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p align="left">
<img width=20% src="https://dai.lids.mit.edu/wp-content/uploads/2018/06/Logo_DAI_highres.png" alt="DAI-Lab" />
<i>An open source project from Data to AI Lab at MIT.</i>
</p><a class="reference external image-reference" href="https://pypi.python.org/pypi/TGAN"><img alt="PyPi Shield" src="https://img.shields.io/pypi/v/TGAN.svg" /></a>
<a class="reference external image-reference" href="https://travis-ci.org/DAI-Lab/TGAN"><img alt="Travis CI Shield" src="https://travis-ci.org/DAI-Lab/TGAN.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://codecov.io/gh/DAI-Lab/TGAN"><img alt="CodeCov" src="https://codecov.io/gh/DAI-Lab/TGAN/branch/master/graph/badge.svg" /></a>
<a class="reference external image-reference" href="https://pepy.tech/project/tgan"><img alt="Downloads" src="https://pepy.tech/badge/tgan" /></a>
<p><em>We are happy to annouce that our new model for synthetic data called `CTGAN &lt;https://DAI-Lab.github.io/CTGAN&gt;`_*</em> is opensourced. *</p>
<div class="section" id="tgan">
<h1>TGAN<a class="headerlink" href="#tgan" title="Permalink to this headline">Â¶</a></h1>
<p>Generative adversarial training for synthesizing tabular data.</p>
<ul class="simple">
<li><p>Free software: MIT license</p></li>
<li><p>Documentation: <a class="reference external" href="https://DAI-Lab.github.io/TGAN">https://DAI-Lab.github.io/TGAN</a></p></li>
<li><p>Homepage: <a class="reference external" href="https://github.com/DAI-Lab/TGAN">https://github.com/DAI-Lab/TGAN</a></p></li>
</ul>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">Â¶</a></h1>
<p>TGAN is a tabular data synthesizer. It can generate fully synthetic data from real data. Currently, TGAN can
generate numerical columns and categorical columns.</p>
</div>
<div class="section" id="requirements">
<h1>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="python">
<h2>Python<a class="headerlink" href="#python" title="Permalink to this headline">Â¶</a></h2>
<p><strong>TGAN</strong> has been developed and runs on Python <a class="reference external" href="https://www.python.org/downloads/release/python-356/">3.5</a>,
<a class="reference external" href="https://www.python.org/downloads/release/python-360/">3.6</a> and
<a class="reference external" href="https://www.python.org/downloads/release/python-370/">3.7</a>.</p>
<p>Also, although it is not strictly required, the usage of a <a class="reference external" href="https://virtualenv.pypa.io/en/latest/">virtualenv</a>
is highly recommended in order to avoid interfering with other software installed in the system where <strong>TGAN</strong>
is run.</p>
</div>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">Â¶</a></h1>
<p>The simplest and recommended way to install TGAN is using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tgan</span>
</pre></div>
</div>
<p>Alternatively, you can also clone the repository and install it from sources</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="o">@</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">:</span><span class="n">DAI</span><span class="o">-</span><span class="n">Lab</span><span class="o">/</span><span class="n">TGAN</span><span class="p">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">TGAN</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>For development, you can use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install-develop</span></code> instead in order to install all the required
dependencies for testing and code linting.</p>
</div>
<div class="section" id="data-format">
<h1>Data Format<a class="headerlink" href="#data-format" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="input-format">
<h2>Input Format<a class="headerlink" href="#input-format" title="Permalink to this headline">Â¶</a></h2>
<p>In order to be able to sample new synthetic data, <strong>TGAN</strong> first needs to be <em>fitted</em> to
existing data.</p>
<p>The input data for this <em>fitting</em> process has to be a single table that satisfies the following
rules:</p>
<ul class="simple">
<li><p>Has no missing values.</p></li>
<li><p>Has columns of types <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p></li>
<li><p>Each column contains data of only one type.</p></li>
</ul>
<p>An example of such a tables would be:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>str_column</p></th>
<th class="head"><p>float_column</p></th>
<th class="head"><p>int_column</p></th>
<th class="head"><p>bool_column</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>â€˜greenâ€™</p></td>
<td><p>0.15</p></td>
<td><p>10</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>â€˜blueâ€™</p></td>
<td><p>7.25</p></td>
<td><p>23</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p>â€˜redâ€™</p></td>
<td><p>10.00</p></td>
<td><p>1</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>â€˜yellowâ€™</p></td>
<td><p>5.50</p></td>
<td><p>17</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<p>As you can see, this table contains 4 columns: <code class="docutils literal notranslate"><span class="pre">str_column</span></code>, <code class="docutils literal notranslate"><span class="pre">float_column</span></code>, <code class="docutils literal notranslate"><span class="pre">int_column</span></code> and
<code class="docutils literal notranslate"><span class="pre">bool_column</span></code>, each one being an example of the supported value types. Notice aswell that there is
no missing values for any of the rows.</p>
<p><strong>NOTE</strong>: Itâ€™s important to have properly identifed which of the columns are numerical, which means
that they represent a magnitude, and which ones are categorical, as during the preprocessing of
the data, numerical and categorical columns will be processed differently.</p>
</div>
<div class="section" id="output-format">
<h2>Output Format<a class="headerlink" href="#output-format" title="Permalink to this headline">Â¶</a></h2>
<p>The output of <strong>TGAN</strong> is a table of sampled data with the same columns as the input table and as
many rows as requested.</p>
</div>
<div class="section" id="demo-datasets">
<h2>Demo Datasets<a class="headerlink" href="#demo-datasets" title="Permalink to this headline">Â¶</a></h2>
<p><strong>TGAN</strong> includes a few datasets to use for development or demonstration purposes. These datasets
come from the <a class="reference external" href="http://archive.ics.uci.edu/ml">UCI Machine Learning repository</a>, and have been
preprocessed to be ready to use with <strong>TGAN</strong>, following the requirements specified in the
<a class="reference external" href="#input-format">Input Format</a> section.</p>
<p>These datasets can be browsed and directly downloaded from the
<a class="reference external" href="http://hdi-project-tgan.s3.amazonaws.com/index.html">hdi-project-tgan AWS S3 Bucket</a></p>
<div class="section" id="census-dataset">
<h3>Census dataset<a class="headerlink" href="#census-dataset" title="Permalink to this headline">Â¶</a></h3>
<p>This dataset contains a single table, with information from the census, labeled with information of
wheter or not the income of is greater than 50.000 $/year. Itâ€™s a single csv file, containing
199522 rows and 41 columns. From these 41 columns, only 7 are identified as continuous. In
<strong>TGAN</strong> this dataset is called <code class="docutils literal notranslate"><span class="pre">census</span></code>.</p>
</div>
<div class="section" id="cover-type">
<h3>Cover type<a class="headerlink" href="#cover-type" title="Permalink to this headline">Â¶</a></h3>
<p>This dataset contains a single table with cartographic information labeled with the different
forrest cover types. Itâ€™s a single csv file, containing 465588 rows and 55 columns. From these
55 columns, 10 are identified as continuous. In <strong>TGAN</strong> this dataset is called <code class="docutils literal notranslate"><span class="pre">covertype</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">Â¶</a></h1>
<p>In this short tutorial we will guide you through a series of steps that will help you getting
started with the most basic usage of <strong>TGAN</strong> in order to generate samples from a given dataset.</p>
<p><strong>NOTE</strong>: The following examples are also covered in a <a class="reference external" href="https://jupyter.org/">Jupyter</a> notebook,
which you can execute by running the following commands inside your <em>virtualenv</em>:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jupyter</span>
<span class="n">jupyter</span> <span class="n">notebook</span> <span class="n">examples</span><span class="o">/</span><span class="n">Usage_Example</span><span class="p">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<div class="section" id="load-the-data">
<h2>1. Load the data<a class="headerlink" href="#load-the-data" title="Permalink to this headline">Â¶</a></h2>
<p>The first step is to load the data wich we will use to fit TGAN. In order to do so, we will first
import the function <code class="docutils literal notranslate"><span class="pre">tgan.data.load_data</span></code> and call it with the name of the dataset that we want to
load.</p>
<p>In this case, we will load the <code class="docutils literal notranslate"><span class="pre">census</span></code> dataset, which we will use during the subsequent steps,
and obtain two objects:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>, that will contain a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with the table of data from the <code class="docutils literal notranslate"><span class="pre">census</span></code>
dataset ready to be used to fit the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">continuous_columns</span></code>, that will contain a <code class="docutils literal notranslate"><span class="pre">list</span></code> with the indices of continuous columns.</p></li>
</ol>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="n">tgan</span><span class="p">.</span><span class="k">data</span> <span class="n">import</span> <span class="n">load_demo_data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">data</span><span class="p">,</span> <span class="n">continuous_columns</span> <span class="o">=</span> <span class="n">load_demo_data</span><span class="p">(</span><span class="s1">&#39;census&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">data</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">T</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
                              <span class="mi">0</span>                                     <span class="mi">1</span>                             <span class="mi">2</span>
<span class="mi">0</span>                            <span class="mi">73</span>                                    <span class="mi">58</span>                            <span class="mi">18</span>
<span class="mi">1</span>               <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>        <span class="k">Self</span><span class="o">-</span><span class="n">employed</span><span class="o">-</span><span class="k">not</span> <span class="n">incorporated</span>               <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>
<span class="mi">2</span>                             <span class="mi">0</span>                                     <span class="mi">4</span>                             <span class="mi">0</span>
<span class="mi">3</span>                             <span class="mi">0</span>                                    <span class="mi">34</span>                             <span class="mi">0</span>
<span class="mi">4</span>          <span class="n">High</span> <span class="n">school</span> <span class="n">graduate</span>            <span class="k">Some</span> <span class="n">college</span> <span class="n">but</span> <span class="k">no</span> <span class="n">degree</span>                    <span class="mi">10</span><span class="n">th</span> <span class="n">grade</span>
<span class="mi">5</span>                             <span class="mi">0</span>                                     <span class="mi">0</span>                             <span class="mi">0</span>
<span class="mi">6</span>               <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>                       <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>                   <span class="n">High</span> <span class="n">school</span>
<span class="mi">7</span>                       <span class="n">Widowed</span>                              <span class="n">Divorced</span>                 <span class="n">Never</span> <span class="n">married</span>
<span class="mi">8</span>   <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span> <span class="k">or</span> <span class="n">children</span>                          <span class="n">Construction</span>   <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span> <span class="k">or</span> <span class="n">children</span>
<span class="mi">9</span>               <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>   <span class="k">Precision</span> <span class="n">production</span> <span class="n">craft</span> <span class="o">&amp;</span> <span class="n">repair</span>               <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">continuous_columns</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">38</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-tgan-instance">
<h2>2. Create a TGAN instance<a class="headerlink" href="#create-a-tgan-instance" title="Permalink to this headline">Â¶</a></h2>
<p>The next step is to import TGAN and create an instance of the model.</p>
<p>To do so, we need to import the <code class="docutils literal notranslate"><span class="pre">tgan.model.TGANModel</span></code> class and call it with the
<code class="docutils literal notranslate"><span class="pre">continuous_columns</span></code> as unique argument.</p>
<p>This will create a TGAN instance with the default parameters:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="n">tgan</span><span class="p">.</span><span class="n">model</span> <span class="n">import</span> <span class="n">TGANModel</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span> <span class="o">=</span> <span class="n">TGANModel</span><span class="p">(</span><span class="n">continuous_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fit-the-model">
<h2>3. Fit the model<a class="headerlink" href="#fit-the-model" title="Permalink to this headline">Â¶</a></h2>
<p>Once you have a <strong>TGAN</strong> instance, you can proceed to call itâ€™s <code class="docutils literal notranslate"><span class="pre">fit</span></code> method passing the <code class="docutils literal notranslate"><span class="pre">data</span></code> that
you loaded before in order to start the fitting process:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="k">data</span><span class="p">)</span>
</pre></div>
</div>
<p>This process will not return anything, however, the progress of the fitting will be printed in the
screen.</p>
<p><strong>NOTE</strong> Depending on the performance of the system you are running, and the parameters selected
for the model, this step can take up to a few hours.</p>
</div>
<div class="section" id="sample-new-data">
<h2>4. Sample new data<a class="headerlink" href="#sample-new-data" title="Permalink to this headline">Â¶</a></h2>
<p>After the model has been fitted, you are ready to generate new samples by calling the <code class="docutils literal notranslate"><span class="pre">sample</span></code>
method of the <code class="docutils literal notranslate"><span class="pre">TGAN</span></code> instance passing it the desired amount of samples:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">tgan</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">samples</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">T</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
                                         <span class="mi">0</span>                                     <span class="mi">1</span>                                   <span class="mi">2</span>
<span class="mi">0</span>                                       <span class="mi">12</span>                                    <span class="mi">27</span>                                  <span class="mi">56</span>

<span class="mi">0</span>                                       <span class="mi">12</span>                                    <span class="mi">27</span>                                  <span class="mi">56</span>
<span class="mi">1</span>                          <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>        <span class="k">Self</span><span class="o">-</span><span class="n">employed</span><span class="o">-</span><span class="k">not</span> <span class="n">incorporated</span>                             <span class="n">Private</span>
<span class="mi">2</span>                                        <span class="mi">0</span>                                     <span class="mi">4</span>                                  <span class="mi">35</span>
<span class="mi">3</span>                                        <span class="mi">0</span>                                    <span class="mi">34</span>                                  <span class="mi">22</span>
<span class="mi">4</span>                                 <span class="n">Children</span>            <span class="k">Some</span> <span class="n">college</span> <span class="n">but</span> <span class="k">no</span> <span class="n">degree</span>          <span class="k">Some</span> <span class="n">college</span> <span class="n">but</span> <span class="k">no</span> <span class="n">degree</span>
<span class="mi">5</span>                                        <span class="mi">0</span>                                     <span class="mi">0</span>                                 <span class="mi">500</span>
<span class="mi">6</span>                          <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>                       <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>                     <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>
<span class="mi">7</span>                            <span class="n">Never</span> <span class="n">married</span>       <span class="n">Married</span><span class="o">-</span><span class="n">civilian</span> <span class="n">spouse</span> <span class="n">present</span>     <span class="n">Married</span><span class="o">-</span><span class="n">civilian</span> <span class="n">spouse</span> <span class="n">present</span>
<span class="mi">8</span>              <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span> <span class="k">or</span> <span class="n">children</span>                          <span class="n">Construction</span>   <span class="n">Finance</span> <span class="n">insurance</span> <span class="k">and</span> <span class="nb">real</span> <span class="n">estate</span>
<span class="mi">9</span>                          <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>   <span class="k">Precision</span> <span class="n">production</span> <span class="n">craft</span> <span class="o">&amp;</span> <span class="n">repair</span>      <span class="n">Adm</span> <span class="n">support</span> <span class="k">including</span> <span class="n">clerical</span>
</pre></div>
</div>
<p>The returned object, <code class="docutils literal notranslate"><span class="pre">samples</span></code>, is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> containing a table of synthetic data with
the same format as the input data and 1000 rows as we requested.</p>
</div>
<div class="section" id="save-and-load-a-model">
<h2>5. Save and Load a model<a class="headerlink" href="#save-and-load-a-model" title="Permalink to this headline">Â¶</a></h2>
<p>In the steps above we saw that the fitting process can take a lot of time, so we probably would
like to avoid having to fit every we want to generate samples. Instead we can fit a model once,
save it, and load it every time we want to sample new data.</p>
<p>If we have a fitted model, we can save it by calling itâ€™s <code class="docutils literal notranslate"><span class="pre">save</span></code> method, that only takes
as argument the path where the model will be stored. Similarly, the <code class="docutils literal notranslate"><span class="pre">TGANModel.load</span></code> allows to load
a model stored on disk by passing as argument the path where the model is stored.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;models/mymodel.pkl&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
<span class="n">Model</span> <span class="n">saved</span> <span class="n">successfully</span><span class="p">.</span>
</pre></div>
</div>
<p>Bear in mind that in case the file already exists, <strong>TGAN</strong> will avoid overwritting it unless the
<code class="docutils literal notranslate"><span class="pre">force=True</span></code> argument is passed:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
<span class="n">The</span> <span class="n">indicated</span> <span class="n">path</span> <span class="n">already</span> <span class="k">exists</span><span class="p">.</span> <span class="n">Use</span> <span class="o">`</span><span class="k">force</span><span class="o">=</span><span class="k">True</span><span class="o">`</span> <span class="k">to</span> <span class="n">overwrite</span><span class="p">.</span>
</pre></div>
</div>
<p>In order to do so:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="k">force</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">Model</span> <span class="n">saved</span> <span class="n">successfully</span><span class="p">.</span>
</pre></div>
</div>
<p>Once the model is saved, it can be loaded back as a <strong>TGAN</strong> instance by using the <code class="docutils literal notranslate"><span class="pre">TGANModel.load</span></code>
method:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">new_tgan</span> <span class="o">=</span> <span class="n">TGANModel</span><span class="p">.</span><span class="k">load</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_samples</span> <span class="o">=</span> <span class="n">new_tgan</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_samples</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">T</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>

                                         <span class="mi">0</span>                                     <span class="mi">1</span>                                   <span class="mi">2</span>
<span class="mi">0</span>                                       <span class="mi">12</span>                                    <span class="mi">27</span>                                  <span class="mi">56</span>

<span class="mi">0</span>                                       <span class="mi">12</span>                                    <span class="mi">27</span>                                  <span class="mi">56</span>
<span class="mi">1</span>                          <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>        <span class="k">Self</span><span class="o">-</span><span class="n">employed</span><span class="o">-</span><span class="k">not</span> <span class="n">incorporated</span>                             <span class="n">Private</span>
<span class="mi">2</span>                                        <span class="mi">0</span>                                     <span class="mi">4</span>                                  <span class="mi">35</span>
<span class="mi">3</span>                                        <span class="mi">0</span>                                    <span class="mi">34</span>                                  <span class="mi">22</span>
<span class="mi">4</span>                                 <span class="n">Children</span>            <span class="k">Some</span> <span class="n">college</span> <span class="n">but</span> <span class="k">no</span> <span class="n">degree</span>          <span class="k">Some</span> <span class="n">college</span> <span class="n">but</span> <span class="k">no</span> <span class="n">degree</span>
<span class="mi">5</span>                                        <span class="mi">0</span>                                     <span class="mi">0</span>                                 <span class="mi">500</span>
<span class="mi">6</span>                          <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>                       <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>                     <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>
<span class="mi">7</span>                            <span class="n">Never</span> <span class="n">married</span>       <span class="n">Married</span><span class="o">-</span><span class="n">civilian</span> <span class="n">spouse</span> <span class="n">present</span>     <span class="n">Married</span><span class="o">-</span><span class="n">civilian</span> <span class="n">spouse</span> <span class="n">present</span>
<span class="mi">8</span>              <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span> <span class="k">or</span> <span class="n">children</span>                          <span class="n">Construction</span>   <span class="n">Finance</span> <span class="n">insurance</span> <span class="k">and</span> <span class="nb">real</span> <span class="n">estate</span>
<span class="mi">9</span>                          <span class="k">Not</span> <span class="k">in</span> <span class="n">universe</span>   <span class="k">Precision</span> <span class="n">production</span> <span class="n">craft</span> <span class="o">&amp;</span> <span class="n">repair</span>      <span class="n">Adm</span> <span class="n">support</span> <span class="k">including</span> <span class="n">clerical</span>
</pre></div>
</div>
<p>At this point we could use this model instance to generate more samples.</p>
</div>
</div>
<div class="section" id="loading-custom-datasets">
<h1>Loading custom datasets<a class="headerlink" href="#loading-custom-datasets" title="Permalink to this headline">Â¶</a></h1>
<p>In the previous steps we used some demonstration data but we did not show you how to load your own
dataset.</p>
<p>In order to do so you will need to generate a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> object from your dataset. If your
dataset is in a <code class="docutils literal notranslate"><span class="pre">csv</span></code> format you can do so by using <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code> and passing to it the path to
the CSV file that you want to load.</p>
<p>Additionally, you will need to create 0-indexed list of columns indices to be considered continuous.</p>
<p>For example, if we want to load a local CSV file, <code class="docutils literal notranslate"><span class="pre">path/to/my.csv</span></code>, that has as continuous columns
their first 4 columns, that is, indices <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>, we would do it like this:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/census.csv&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">continuous_columns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>Now you can use the <code class="docutils literal notranslate"><span class="pre">continuous_columns</span></code> to create a <strong>TGAN</strong> instance and use the <code class="docutils literal notranslate"><span class="pre">data</span></code> to <code class="docutils literal notranslate"><span class="pre">fit</span></code>
it, like we did before:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="n">tgan</span><span class="p">.</span><span class="n">model</span> <span class="n">import</span> <span class="n">TGANModel</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span> <span class="o">=</span> <span class="n">TGANModel</span><span class="p">(</span><span class="n">continuous_columns</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="k">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="model-parameters">
<h1>Model Parameters<a class="headerlink" href="#model-parameters" title="Permalink to this headline">Â¶</a></h1>
<p>If you want to change the default behavior of <code class="docutils literal notranslate"><span class="pre">TGANModel</span></code>, such as as different <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> or
<code class="docutils literal notranslate"><span class="pre">num_epochs</span></code>, you can do so by passing different arguments when creating the instance.</p>
<div class="section" id="model-general-behavior">
<h2>Model general behavior<a class="headerlink" href="#model-general-behavior" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>continous_columns (<code class="docutils literal notranslate"><span class="pre">list[int]</span></code>, required): List of columns indices to be considered continuous.</p></li>
<li><p>output (<code class="docutils literal notranslate"><span class="pre">str</span></code>, default=<code class="docutils literal notranslate"><span class="pre">output</span></code>): Path to store the model and its artifacts.</p></li>
</ul>
</div>
<div class="section" id="neural-network-definition-and-fitting">
<h2>Neural network definition and fitting<a class="headerlink" href="#neural-network-definition-and-fitting" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>max_epoch (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">100</span></code>): Number of epochs to use during training.</p></li>
<li><p>steps_per_epoch (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">10000</span></code>): Number of steps to run on each epoch.</p></li>
<li><p>save_checkpoints(<code class="docutils literal notranslate"><span class="pre">bool</span></code>, default=True): Whether or not to store checkpoints of the model after each training epoch.</p></li>
<li><p>restore_session(<code class="docutils literal notranslate"><span class="pre">bool</span></code>, default=True): Whether or not continue training from the last checkpoint.</p></li>
<li><p>batch_size (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">200</span></code>): Size of the batch to feed the model at each step.</p></li>
<li><p>z_dim (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">100</span></code>): Number of dimensions in the noise input for the generator.</p></li>
<li><p>noise (<code class="docutils literal notranslate"><span class="pre">float</span></code>, default=<code class="docutils literal notranslate"><span class="pre">0.2</span></code>): Upper bound to the gaussian noise added to categorical columns.</p></li>
<li><p>l2norm (<code class="docutils literal notranslate"><span class="pre">float</span></code>, default=<code class="docutils literal notranslate"><span class="pre">0.00001</span></code>): L2 reguralization coefficient when computing losses.</p></li>
<li><p>learning_rate (<code class="docutils literal notranslate"><span class="pre">float</span></code>, default=<code class="docutils literal notranslate"><span class="pre">0.001</span></code>): Learning rate for the optimizer.</p></li>
<li><p>num_gen_rnn (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">400</span></code>): Number of units in rnn cell in generator.</p></li>
<li><p>num_gen_feature (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">100</span></code>): Number of units in fully connected layer in generator.</p></li>
<li><p>num_dis_layers (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">2</span></code>): Number of layers in discriminator.</p></li>
<li><p>num_dis_hidden (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">200</span></code>): Number of units per layer in discriminator.</p></li>
<li><p>optimizer (<code class="docutils literal notranslate"><span class="pre">str</span></code>, default=<code class="docutils literal notranslate"><span class="pre">AdamOptimizer</span></code>): Name of the optimizer to use during <code class="docutils literal notranslate"><span class="pre">fit</span></code>, possible
values are: [<code class="docutils literal notranslate"><span class="pre">GradientDescentOptimizer</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamOptimizer</span></code>, <code class="docutils literal notranslate"><span class="pre">AdadeltaOptimizer</span></code>].</p></li>
</ul>
<p>If you wanted to create an identical instance to the one created on step 2, but passing the
arguments in a explicit way, this can be achieved with the following lines:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="n">tgan</span><span class="p">.</span><span class="n">model</span> <span class="n">import</span> <span class="n">TGANModel</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tgan</span> <span class="o">=</span> <span class="n">TGANModel</span><span class="p">(</span>
   <span class="p">...:</span>     <span class="n">continuous_columns</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="k">output</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">max_epoch</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">save_checkpoints</span><span class="o">=</span><span class="k">True</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">restore_session</span><span class="o">=</span><span class="k">True</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">batch_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">z_dim</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">noise</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">l2norm</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">00001</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">learning_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">num_gen_rnn</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">num_gen_feature</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">num_dis_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">num_dis_hidden</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
   <span class="p">...:</span>     <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;AdamOptimizer&#39;</span>
   <span class="p">...:</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="command-line-interface">
<h1>Command-line interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">Â¶</a></h1>
<p>We include a command-line interface that allows users to access TGAN functionality. Currently only
one action is supported.</p>
<div class="section" id="random-hyperparameter-search">
<h2>Random hyperparameter search<a class="headerlink" href="#random-hyperparameter-search" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="input">
<h3>Input<a class="headerlink" href="#input" title="Permalink to this headline">Â¶</a></h3>
<p>To run random searchs for the best model hyperparameters for a given dataset, we will need:</p>
<ul class="simple">
<li><p>A dataset, in a csv file, without any missing value, only columns of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code> or
<code class="docutils literal notranslate"><span class="pre">float</span></code> and only one type for column, as specified in the <a class="reference external" href="#input-format">Input Format</a>.</p></li>
<li><p>A JSON file containing the configuration for the search. This configuration shall contain:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Name of the experiment. A folder with this name will be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_random_search</span></code>: Number of iterations in hyper parameter search.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train_csv</span></code>: Path to the csv file containing the dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">continuous_cols</span></code>: List of column indices, starting at 0, to be considered continuous.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epoch</span></code>: Number of epoches to train the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">steps_per_epoch</span></code>: Number of optimization steps in each epoch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_rows</span></code>: Number of rows to sample when evaluating the model.</p></li>
</ul>
</li>
</ul>
<p>You can see an example of such a json file in <a class="reference external" href="examples/config.json">examples/config.json</a>, which you
can download and use as a template.</p>
</div>
<div class="section" id="execution">
<h3>Execution<a class="headerlink" href="#execution" title="Permalink to this headline">Â¶</a></h3>
<p>Once we have prepared everything we can launch the random hyperparameter search with this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tgan experiments config.json results.json
</pre></div>
</div>
<p>Where the first argument, <code class="docutils literal notranslate"><span class="pre">config.json</span></code>, is the path to your configuration JSON, and the second,
<code class="docutils literal notranslate"><span class="pre">results.json</span></code>, is the path to store the summary of the execution.</p>
<p>This will run the random search, wich basically consist of the folling steps:</p>
<ol class="arabic simple">
<li><p>We fetch and split our data between test and train.</p></li>
<li><p>We randomly select the hyperparameters to test.</p></li>
<li><p>Then, for each hyperparameter combination, we train a TGAN model using the real training data T
and generate a synthetic training dataset Tsynth.</p></li>
<li><p>We then train machine learning models on both the real and synthetic datasets.</p></li>
<li><p>We use these trained models on real test data and see how well they perform.</p></li>
</ol>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">Â¶</a></h3>
<p>After the experiment has finished, the following can be found:</p>
<ul class="simple">
<li><p>A JSON file, in the example above called <code class="docutils literal notranslate"><span class="pre">results.json</span></code>, containing a summary of the experiments.
This JSON will contain a key for each experiment <code class="docutils literal notranslate"><span class="pre">name</span></code>, and on it, an array of length
<code class="docutils literal notranslate"><span class="pre">num_random_search</span></code>, with the selected parameters and its evaluation score. For a configuration
like the example, the summary will look like this:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;census&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;steps_per_epoch&quot;</span> <span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
            <span class="s2">&quot;num_gen_feature&quot;</span> <span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s2">&quot;num_dis_hidden&quot;</span> <span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s2">&quot;batch_size&quot;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;num_gen_rnn&quot;</span> <span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
            <span class="s2">&quot;score&quot;</span> <span class="p">:</span> <span class="mf">0.937802280415988</span><span class="p">,</span>
            <span class="s2">&quot;max_epoch&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;num_dis_layers&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;learning_rate&quot;</span> <span class="p">:</span> <span class="mf">0.0002</span><span class="p">,</span>
            <span class="s2">&quot;z_dim&quot;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;noise&quot;</span> <span class="p">:</span> <span class="mf">0.2</span>
        <span class="p">},</span>
        <span class="o">...</span> <span class="c1"># 9 more nodes</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>A set of folders, each one names after the <code class="docutils literal notranslate"><span class="pre">name</span></code> specified in the JSON configuration, contained
in the <code class="docutils literal notranslate"><span class="pre">experiments</span></code> folder. In each folder, sampled data and the models can be found. For a configuration
like the example, this will look like this:</p></li>
</ul>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">experiments</span><span class="o">/</span>
  <span class="n">census</span><span class="o">/</span>
    <span class="k">data</span><span class="o">/</span>       <span class="o">#</span> <span class="n">Sampled</span> <span class="k">data</span> <span class="k">with</span> <span class="k">each</span> <span class="k">of</span> <span class="n">the</span> <span class="n">models</span> <span class="k">in</span> <span class="n">the</span> <span class="n">random</span> <span class="k">search</span><span class="p">.</span>
    <span class="n">model_0</span><span class="o">/</span>
      <span class="n">logs</span><span class="o">/</span>     <span class="o">#</span> <span class="n">Training</span> <span class="n">logs</span>
      <span class="n">model</span><span class="o">/</span>    <span class="o">#</span> <span class="n">Tensorflow</span> <span class="n">model</span> <span class="n">checkpoints</span>
    <span class="n">model_1</span><span class="o">/</span>    <span class="o">#</span> <span class="mi">9</span> <span class="k">more</span> <span class="n">folders</span><span class="p">,</span> <span class="n">one</span> <span class="k">for</span> <span class="k">each</span> <span class="n">model</span> <span class="k">in</span> <span class="n">the</span> <span class="n">random</span> <span class="k">search</span>
    <span class="p">...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="research">
<h1>Research<a class="headerlink" href="#research" title="Permalink to this headline">Â¶</a></h1>
<p>The first <strong>TAGN</strong> version was built as the supporting software for the <a class="reference external" href="https://arxiv.org/pdf/1811.11264.pdf">Synthesizing Tabular Data using Generative Adversarial Networks</a> paper by Lei Xu and Kalyan Veeramachaneni.</p>
<p>The exact version of software mentioned in the paper can be found in the releases section as the <a class="reference external" href="https://github.com/DAI-Lab/TGAN/releases/tag/research">research pre-release</a></p>
</div>
<div class="section" id="what-s-next">
<h1>Whatâ€™s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">Â¶</a></h1>
<p>For more details about <strong>TGAN</strong> and all its possibilities and features, please check the
<a class="reference external" href="https://DAI-Lab.github.io/TGAN/">project documentation site</a>!</p>
</div>
<div class="section" id="citing-tgan">
<h1>Citing TGAN<a class="headerlink" href="#citing-tgan" title="Permalink to this headline">Â¶</a></h1>
<p>If you use TGAN for yor research, please consider citing the following paper (<a class="reference external" href="https://arxiv.org/pdf/1811.11264.pdf">https://arxiv.org/pdf/1811.11264.pdf</a>):</p>
<p>If you use TGAN, please cite the following work:</p>
<blockquote>
<div><p>Lei Xu, Kalyan Veeramachaneni. 2018. Synthesizing Tabular Data using Generative Adversarial Networks.</p>
</div></blockquote>
<div class="highlight-LaTeX notranslate"><div class="highlight"><pre><span></span>@article<span class="nb">{</span>xu2018synthesizing,
  title=<span class="nb">{</span>Synthesizing Tabular Data using Generative Adversarial Networks<span class="nb">}</span>,
  author=<span class="nb">{</span>Xu, Lei and Veeramachaneni, Kalyan<span class="nb">}</span>,
  journal=<span class="nb">{</span>arXiv preprint arXiv:1811.11264<span class="nb">}</span>,
  year=<span class="nb">{</span>2018<span class="nb">}</span>
<span class="nb">}</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/tgan.html" class="btn btn-neutral float-right" title="tgan package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="TGAN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MIT Data To AI Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>